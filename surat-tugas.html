<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generator Surat Tugas | PKM Kiarapedes</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
       @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;800&display=swap');
        
        :root { 
            --bg-body: #f8fafc; 
            --bg-card: #ffffff; 
            --text-main: #1e293b; 
            --border-color: #e2e8f0; 
            --input-bg: rgba(0,0,0,0.05);
        }

        /* Definisi Tema Gelap */
        .dark {
            --bg-body: #0f172a;
            --bg-card: #1e293b;
            --text-main: #f1f5f9;
            --border-color: #334155;
            --input-bg: rgba(255,255,255,0.05);
        }

        body { 
            font-family: 'Plus Jakarta Sans', sans-serif; 
            background-color: var(--bg-body); 
            color: var(--text-main); 
            transition: all 0.3s ease; 
        }

        .glass-header { background: linear-gradient(135deg, #064e3b 0%, #059669 100%); }
        .card-custom { background-color: var(--bg-card); border-radius: 1.25rem; border: 1px solid var(--border-color); }
        
        .input-modern { 
            width: 100%; padding: 0.75rem 1rem; 
            background-color: var(--input-bg); 
            border: 2px solid transparent; 
            border-radius: 0.75rem; 
            font-weight: 600; font-size: 0.875rem; 
            color: var(--text-main);
            outline: none; 
        }
        .input-modern:focus { border-color: #10b981; background-color: var(--bg-card); }

        /* Khusus Area Kertas - Harus tetap putih agar hasil print benar */
        #kertasPreview { background-color: white !important; color: black !important; }

         @media print {
        /* Sembunyikan semua elemen kecuali areaCetak */
        body * {
            visibility: hidden;
        }
        
        #areaCetak, #areaCetak * {
            visibility: visible;
        }

        /* Atur posisi areaCetak agar mulai dari pojok kiri atas kertas */
        #areaCetak {
            position: absolute;
            left: 0;
            top: 0;
            width: 100% !important;
            padding: 1.5cm 2cm !important;
            visibility: visible !important;
            display: block !important;
        }

        /* Hilangkan margin default browser dan shadow */
        @page {
            size: portrait;
            margin: 0;
        }
        
        .no-print, header, button {
            display: none !important;
        }
    }
    </style>
</head>
<body class="pb-10">

<header class="glass-header text-white pb-24 pt-10 px-6 no-print">
    <div class="container mx-auto flex justify-between items-center">
        <div class="flex items-center gap-4">
            <i class="fas fa-edit text-5xl text-yellow-400"></i>
            
            <div>
                <h1 class="text-2xl font-black italic uppercase leading-none">
                    E-Surat <span class="text-emerald-400">Tugas</span>
                </h1>
                <p class="text-emerald-400 font-bold text-sm tracking-widest uppercase mt-1">
                    Puskesmas Kiarapedes
                </p>
            </div>
        </div>
        <div class="flex items-center gap-3">
                
                <button onclick="toggleTheme()" <i id="themeIcon" class='fas fa-eye' style='font-size:24px;color:white'></i></button>
                <a href="e-arsip.html" class="bg-amber-500 hover:bg-emerald-600 px-4 py-2 rounded-full text-[10px] font-black uppercase shadow-lg"><i class="fas fa-folder-open mr-2"></i> Buka Arsip</a>
                <button onclick="window.location.reload()" class="bg-rose-600 hover:bg-sky-500 px-4 py-2 rounded-full text-[10px] font-black uppercase"><i id="syncIcon" class="fas fa-sync mr-2"></i> Reset Form</button>
        </div>
    </div>
</header>

<main class="container mx-auto px-6 -mt-16 no-print">
    <div class="grid grid-cols-1 lg:grid-cols-12 gap-8">
        
        <div class="lg:col-span-4">
            <div class="card-custom p-6 space-y-4 shadow-xl sticky top-4">
                <h3 class="text-xs font-black uppercase text-emerald-600 border-b pb-2 italic">Form Surat</h3>
                
                <div class="grid grid-cols-2 gap-3">
                    <div>
                        <label class="text-[9px] font-bold text-slate-400 uppercase ml-2">No Urut</label>
                        <input type="number" id="noUrut" class="input-modern" placeholder="001" oninput="updatePreview()">
                    </div>
                    <div>
                        <label class="text-[9px] font-bold text-slate-400 uppercase ml-2">Tgl Surat Dibuat</label>
                        <input type="date" id="tglDibuat" class="input-modern" onchange="updatePreview()">
                    </div>
                </div>

           <div class="bg-slate-50 p-4 rounded-xl border border-dashed border-slate-300">
                    <h4 class="text-[9px] font-black uppercase text-slate-500 mb-3 text-center">Pilih Pegawai yang Ditugaskan</h4>
                    <input type="text" id="namaPegawai" list="listPegawai" class="input-modern mb-2" placeholder="Cari Pegawai..." oninput="autoIsiPegawai()">
                    <datalist id="listPegawai"></datalist>
                    <button onclick="tambahPegawai()" class="w-full bg-emerald-600 text-white font-bold py-2 rounded-lg text-xs hover:bg-emerald-700"> Tambah ke Daftar</button>
                </div>

<div class="grid grid-cols-2 gap-3 border-t pt-4">
    <div>
        <label class="text-[9px] font-bold text-slate-400 uppercase ml-2">Hari Pelaksanaan</label>
        <select id="hariTugas" class="input-modern cursor-pointer" onchange="updatePreview()">
            <option value="">-- Pilih Hari --</option>
            <option value="Senin">Senin</option>
            <option value="Selasa">Selasa</option>
            <option value="Rabu">Rabu</option>
            <option value="Kamis">Kamis</option>
            <option value="Jumat">Jumat</option>
            <option value="Sabtu">Sabtu</option>
            <option value="Minggu">Minggu</option>
        </select>
    </div>
    <div>
        <label class="text-[9px] font-bold text-slate-400 uppercase ml-2">Tgl Pelaksanaan</label>
        <input type="date" id="tglTugas" class="input-modern" onchange="updatePreview()">
    </div>
</div>
                  <div class="grid grid-cols-2 gap-3">
                    <input type="text" id="waktuTugas" class="input-modern" placeholder="Waktu (08.00...)" oninput="updatePreview()">
                    <input type="text" id="tempatTugas" class="input-modern" placeholder="Tempat..." oninput="updatePreview()">
                </div>

                <textarea id="maksudTugas" class="input-modern h-20" placeholder="Maksud / Tujuan Tugas..." oninput="updatePreview()"></textarea>

                <button onclick="window.print()" class="w-full bg-slate-800 text-white font-black py-4 rounded-xl uppercase text-xs shadow-lg">
                    <i class="fas fa-print mr-2"></i> Cetak Surat Tugas
                </button>
            </div>
        </div>

        <div class="lg:col-span-8">
            <div class="card-custom p-10 bg-white shadow-2xl border-none">
                <div id="areaCetak" class="text-black mx-auto" style="width: 100%; max-width: 21.5cm; font-family: 'Times New Roman', serif; line-height: 1.5;">
                    
                    <div class="flex items-center border-b-[4px] border-double border-black pb-2 mb-6">
                        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/f/f7/Seal_of_Purwakarta_Regency.svg/330px-Seal_of_Purwakarta_Regency.svg.png" style="width: 2.5cm; height: 2.5cm; object-fit: contain;">
                        <div class="flex-1 text-center px-4">
                            <h2 class="text-lg font-bold uppercase leading-tight">Pemerintah Kabupaten Purwakarta</h2>
                            <h2 class="text-xl font-bold uppercase leading-tight">Dinas Kesehatan</h2>
                            <h2 class="text-2xl font-black uppercase leading-tight">UPTD Puskesmas Kiarapedes</h2>
                            <p class="text-[11px]">Jl. Raya Kiarapedes No. 2 KM. 28 Kec. Kiarapedes Kode Pos 41175</p>
                        </div>
                        <img src="https://images.seeklogo.com/logo-png/35/1/puskesmas-logo-png_seeklogo-359624.png" style="width: 2.5cm; height: 2.5cm; object-fit: contain;">
                    </div>

                    <div class="text-center mb-6">
                        <h3 class="font-bold underline uppercase text-lg">Surat Tugas</h3>
                        <p id="p_nomor" class="font-bold">Nomor: 800/000/ST/PKM-KPDS/II/2026</p>
                    </div>

                    <div class="text-[14px] mb-4 space-y-1">
                        <p>Yang bertanda tangan di bawah ini :</p>
                        <div class="pl-8 flex"><span class="w-24">Nama</span><span class="mr-2">:</span><span class="font">H. Ujang Sutrisna, S.Kep., Ners., M.Kep</span></div>
                        <div class="pl-8 flex"><span class="w-24">NIP</span><span class="mr-2">:</span><span>197707132006041011</span></div>
                        <div class="pl-8 flex"><span class="w-24">Jabatan</span><span class="mr-2">:</span><span>Kepala UPTD Puskesmas Kiarapedes</span></div>
                    </div>

                    <div class="text-center my-6"><h3 class="font-bold tracking-[0.3em] uppercase">M E N U G A S K A N</h3></div>
                    <p class="text-[14px] mb-2">Kepada :</p>
                    
                    <table class="w-full mb-6 text-[13px] border-collapse border border-black">
                        <thead>
                            <tr class="bg-gray-50">
                                <th class="border border-black p-2 w-8 text-center">No</th>
                                <th class="border border-black p-2 text-center">Nama Lengkap</th>
                                <th class="border border-black p-2 text-center w-44">NIP/NIPPPK</th>
                                <th class="border border-black p-2 text-center">Jabatan</th>
                            </tr>
                        </thead>
                        <tbody id="p_tabel_pegawai">
                            <tr><td colspan="4" class="border border-black p-4 text-center italic text-gray-400">Daftar Pegawai Kosong</td></tr>
                        </tbody>
                    </table>

                    <div class="text-[14px] space-y-1">
                       <div class="text-[14px] mt-4 mb-4">
                        <p class="text-justify leading-relaxed">
                            Menugaskan kepada nama-nama tersebut di atas untuk mengikuti <span id="p_maksud" class="font-medium underline decoration-dotted">..................</span> yang akan dilaksanakan pada:
                        </p>
                    </div>
                        <div class="flex items-start"><span class="w-24 flex-shrink-0">Hari</span><span class="mr-2">:</span><span id="p_hari" class="flex-1">..................</span></div>
                        <div class="flex items-start"><span class="w-24 flex-shrink-0">Tanggal</span><span class="mr-2">:</span><span id="p_tgl_tugas" class="flex-1">..................</span></div>
                        <div class="flex items-start"><span class="w-24 flex-shrink-0">Waktu</span><span class="mr-2">:</span><span id="p_waktu" class="flex-1">..................</span></div>
                        <div class="flex items-start"><span class="w-24 flex-shrink-0">Tempat</span><span class="mr-2">:</span><span id="p_tempat" class="flex-1">..................</span></div>
                        <p class="pt-4">Demikian surat ini dibuat untuk dilaksanakan sebagaimana mestinya dengan penuh rasa tanggung jawab.</p>
                    </div>

                    <div class="mt-12 flex justify-end">
                        <div class="text-center w-72 text-[14px]">
                            <p>Kiarapedes, <span id="p_tgl_dibuat">..................</span></p>
                            <p class="font-bold setencecase leading-tight mt-1">Kepala <br>UPTD Puskesmas Kiarapedes</p>
                            <div class="my-4 border border-dashed border-slate-200 h-24 flex items-center justify-center text-[8px] text-slate-300">[ AREA TTE ]</div>
                       </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</main>

<script>
    // Data Pegawai (Sesuai List Anda)
    const Data_Pegawai = [
        { nama: "Ajat Hermawan", nip: "198102202025211054", jabatan: "Operator Layanan Operasional" },
        { nama: "Anas Muhiban, S.E.", nip: "199703242025211057", jabatan: "Penata Layanan Operasional" },
        { nama: "apt. Herni Ekaraharjo, S. Farm", nip: "198509272023212004", jabatan: "Ahli Pertama - Apoteker" },
        { nama: "apt. Tria Wulandari P, S. Farm", nip: "199210082022032009", jabatan: "Apoteker Ahli Muda" },
        { nama: "Ardiansyah Astriadi, A. Md. AK", nip: "198907272022031007", jabatan: "Pranata Laboratorium Kesehatan Terampil" },
        { nama: "Ari Niken Palupi, Amd.Keb.", nip: "198501202017042001", jabatan: "Bidan Mahir" },
        { nama: "Barir Ismaya Shofa, A. Md.", nip: "199307252019032006", jabatan: "Perawat Gigi Pelaksana/Terampil" },
        { nama: "Ceceng Firmansyah", nip: "198405232025211107", jabatan: "Pengelola Umum Operasional" },
        { nama: "Cici Wijayanti, Amd.Keb", nip: "198608022024212010", jabatan: "Bidan Terampil" },
        { nama: "Cindyaningrum, Amd. Keb", nip: "199401272025212073", jabatan: "Bidan Terampil" },
        { nama: "Cucu Cuhayati, S.Tr. Keb.", nip: "199408202024212013", jabatan: "Bidan Terampil" },
        { nama: "Cucu Suminar, Amd.Kep", nip: "196804171989032007", jabatan: "Perawat Penyelia" },
        { nama: "Dewi Novianti, Amk", nip: "198311112023212003", jabatan: "Terampil - Perawat" },
        { nama: "Dewi Yuliani, AMK", nip: "199103132024212002", jabatan: "Perawat Terampil" },
        { nama: "Dika Megianty Agustin, S.M.", nip: "199708222025212061", jabatan: "Penata Layanan Operasional" },
        { nama: "Dodo Widodo", nip: "198410122025211067", jabatan: "Operator Layanan Operasional" },
        { nama: "dr. Anna Mardyana", nip: "198606172023212005", jabatan: "Ahli Pertama - Dokter" },
        { nama: "dr. Hendric Hariansyah, M.K.M", nip: "199603282022031009", jabatan: "Dokter Ahli Muda" },
        { nama: "dr. Rizki Prasetyo", nip: "123456789101112134", jabatan: "Dokter Umum" },
        { nama: "dr. Zakariya", nip: "197509222006041007", jabatan: "Dokter Ahli Madya" },
        { nama: "drg. Fitri Nurzanah", nip: "199902032025062009", jabatan: "Dokter Gigi Ahli Pertama" },
        { nama: "Eka Prisna Nengsih, Amd. Kep", nip: "199605152025212081", jabatan: "Perawat Terampil" },
        { nama: "Garry Rachman, Amd.Kep", nip: "198509132025211002", jabatan: "Perawat Terampil" },
        { nama: "H. Ujang Sutrisna, S. Kep., Ners., M. Kep.", nip: "197707132006041011", jabatan: "Kepala Puskesmas Kiarapedes" },
        { nama: "Harbangkit Rizki, Amd. Kes", nip: "199605202022031014", jabatan: "Perekam Medis Terampil" },
        { nama: "Haris Ridwansyah, S. Kep. Ners.", nip: "198105202008011004", jabatan: "Perawat Penyelia" },
        { nama: "Imas Teti Sugiharti, Amd.Keb", nip: "198702172017042001", jabatan: "Bidan Mahir" },
        { nama: "Irma Septiani, Amd. Keb.", nip: "199309082025212079", jabatan: "Bidan Terampil" },
        { nama: "Juwita Pebrara, Amd. Keb.", nip: "199002092024212007", jabatan: "Bidan Terampil" },
        { nama: "Kartikasari, Amd. Keb", nip: "199504232025212088", jabatan: "Bidan Terampil" },
        { nama: "Komariah, Amd.Keb.", nip: "198208202023212002", jabatan: "Terampil - Bidan" },
        { nama: "Lusi Fitriyani Caturmawati, A. Md. Farm", nip: "199104132022032013", jabatan: "Asisten Apoteker Terampil" },
        { nama: "Marina, Amd. Keb", nip: "199303052025212078", jabatan: "Bidan Terampil" },
        { nama: "Merri Diana, S.Tr. Keb.", nip: "197205122006042012", jabatan: "Bidan Penyelia" },
        { nama: "Mimah Nurhalimah, Amd.Keb", nip: "199106152025212098", jabatan: "Bidan Terampil" },
        { nama: "Muhamad Haris Romdoni, AMK.", nip: "199502052024211005", jabatan: "Perawat Terampil" },
        { nama: "Neni Supriyani, Amk", nip: "198204192008012006", jabatan: "Perawat Penyelia" },
        { nama: "Nining", nip: "198204072025212053", jabatan: "Operator Layanan Operasional" },
        { nama: "Popy Hasanah, Amd. AK", nip: "199812292024212009", jabatan: "Pranata Laboratorium Kesehatan Terampil" },
        { nama: "Rahayu Ratnasari, Amg", nip: "199103232019032003", jabatan: "Nutrisionis Mahir" },
        { nama: "Ratna Dewi, Amd.Keb", nip: "199101142024212015", jabatan: "Bidan Terampil" },
        { nama: "Rizki Rangga Triyana, A.Md. Kep.", nip: "198903012019031002", jabatan: "Perawat Mahir" },
        { nama: "Rohman", nip: "198610292025211068", jabatan: "Operator Layanan Operasional" },
        { nama: "Rudi Subarkat, S. Kep", nip: "199109232023211003", jabatan: "Terampil - Perawat" },
        { nama: "Samirah, Amd. Keb.", nip: "198905312024212002", jabatan: "Tenaga Promosi Kesehatan Dan Ilmu Perilaku Terampil" },
        { nama: "Siska Apriliani, Amd. Keb.", nip: "199804132024212005", jabatan: "Bidan Terampil" },
        { nama: "Siswinarti, S.Kep. Ners.", nip: "198204272009022005", jabatan: "Perawat Ahli Pertama" },
        { nama: "Siti Fatimah, Amk", nip: "199108042024212012", jabatan: "Perawat Terampil" },
        { nama: "Siti Rohmah, AMK", nip: "198306252008012002", jabatan: "Perawat Penyelia" },
        { nama: "Sri Endang Sukmayati", nip: "200206012025212009", jabatan: "Operator Layanan Operasional" },
        { nama: "Sri Sumarti, SKM", nip: "197503232006042021", jabatan: "Bidan Pelaksana Lanjutan / Mahir" },
        { nama: "Susilawati, Amd.Keb.", nip: "198404062019032004", jabatan: "Bidan Mahir" },
        { nama: "Tanti Kemalasari, Amd.Farm.", nip: "199511192024212009", jabatan: "Asisten Apoteker Terampil" },
        { nama: "Tating Kusmiati, Amd. Keb.", nip: "199310112024212011", jabatan: "Bidan Terampil" },
        { nama: "Tika Ayu Lestari, Amd. Keb.", nip: "199402012025212076", jabatan: "Bidan Terampil" },
        { nama: "Tita Rosmiati, Amd.Keb", nip: "197608182006042023", jabatan: "Bidan Pelaksana Lanjutan / Mahir" },
        { nama: "Titin Sutinah, Amd. Keb", nip: "197701212006042012", jabatan: "Bidan Mahir" },
        { nama: "Tika Azlia Rachmawati, Amd.Kes", nip: "200209092025062007", jabatan: "Tenaga Sanitasi Lingkungan Terampil" },
        { nama: "Ujang Kartono", nip: "198103222009011001", jabatan: "Pengadministrasi Umum" },
        { nama: "Vivit Nopiyanti, Amd.Keb.", nip: "198411042017042001", jabatan: "Bidan Mahir" },
        { nama: "Widya Kusumawati, S.E.", nip: "199708152025212066", jabatan: "Penata Layanan Operasional" },
        { nama: "Yeni Heryani", nip: "198510212025212047", jabatan: "Operator Layanan Operasional" }
    ];

    let listTerpilih = [];

    // TEMA: Toggle Dark/Light
    function toggleTheme() {
        document.body.classList.toggle('dark');
        const icon = document.getElementById('themeIcon');
        icon.className = document.body.classList.contains('dark') ? 'fas fa-low-vision' : 'fas fa-eye';
    }

    // AUTOFILL
    window.onload = () => {
        const dl = document.getElementById('listPegawai');
        Data_Pegawai.forEach(p => {
            let o = document.createElement('option');
            o.value = p.nama;
            dl.appendChild(o);
        });
        updatePreview();
    };

    function autoIsiPegawai() {
        const val = document.getElementById('namaPegawai').value;
        const p = Data_Pegawai.find(x => x.nama === val);
        if(p && !listTerpilih.find(x => x.nip === p.nip)) {
            listTerpilih.push(p);
            document.getElementById('namaPegawai').value = "";
            renderList();
            updatePreview();
        }
    }

    function renderList() {
        document.getElementById('daftarTerpilih').innerHTML = listTerpilih.map((p, i) => `
            <div class="flex justify-between items-center bg-emerald-500/10 p-2 rounded border border-emerald-500/20 text-[10px]">
                <span class="font-bold">${p.nama}</span>
                <button onclick="listTerpilih.splice(${i},1);renderList();updatePreview();" class="text-rose-500 hover:text-rose-700">
                    <i class="fas fa-times-circle"></i>
                </button>
            </div>
        `).join('');
    }

    function formatTgl(s) {
        if(!s) return "..................";
        return new Date(s).toLocaleDateString('id-ID', { day:'numeric', month:'long', year:'numeric' });
    }

    function updatePreview() {
        const no = (document.getElementById('noUrut').value || "000").padStart(3, '0');
        const tglD = document.getElementById('tglDibuat').value;
        const d = tglD ? new Date(tglD) : new Date();
        const romawi = ["I","II","III","IV","V","VI","VII","VIII","IX","X","XI","XII"][d.getMonth()];
        
        document.getElementById('p_nomor').innerText = `Nomor: 800/${no}/ST/PKM-KPDS/${romawi}/${d.getFullYear()}`;
        document.getElementById('p_tgl_dibuat').innerText = formatTgl(tglD);
        document.getElementById('p_tgl_tugas').innerText = formatTgl(document.getElementById('tglTugas').value);
        document.getElementById('p_hari').innerText = document.getElementById('hariTugas').value || "..................";
        document.getElementById('p_waktu').innerText = document.getElementById('waktuTugas').value || "..................";
        document.getElementById('p_tempat').innerText = document.getElementById('tempatTugas').value || "..................";
        
        const maksud = document.getElementById('maksudTugas').value;
        document.getElementById('p_maksud').innerText = maksud ? maksud : "...";

        const tbody = document.getElementById('p_tabel_pegawai');
        tbody.innerHTML = listTerpilih.length === 0 ? 
            '<tr><td colspan="4" class="border border-black p-4 text-center italic opacity-30">Daftar Pegawai Kosong</td></tr>' :
            listTerpilih.map((p, i) => `
                <tr>
                    <td class="border border-black p-1 text-center">${i+1}</td>
                    <td class="border border-black p-1 font-bold uppercase">${p.nama}</td>
                    <td class="border border-black p-1 text-center">${p.nip}</td>
                    <td class="border border-black p-1 text-[11px]">${p.jabatan}</td>
                </tr>
            `).join('');
    }

    // PERBAIKAN FUNGSI PRINT
    function jalankanCetak() {
        updatePreview();
        window.focus(); 
        // Memberi jeda sedikit agar browser siap
        setTimeout(() => {
            window.print();
        }, 300);
    }
</script>
</body>
</html>
